function theta3 = joint3(p, q, axis, goal, axis_offset)
    % p: a point on axis 4
    % q: a point on axis 1 and axis 2
    pt = p - axis_offset
    qt = q- axis_offset
    goalxp = goal * [p; 1];
    goalxp(4) = [];
    d = norm(goalxp-q)
    [theta3, ~] = subproblem.sp_3(pt, qt, axis, d);
end